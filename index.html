<!DOCTYPE html>
<html>
<head>
<title>Razx RP Support System</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{background:#0b0b0b;color:#fff;font-family:Arial}
h2,h3{color:#ff2e2e}
.box{background:#151515;padding:15px;margin:10px;border-radius:10px}
input,textarea,select,button{
 width:100%;padding:10px;margin-top:8px;
 border:none;border-radius:6px
}
button{background:#ff2e2e;color:white;font-weight:bold}
.ticket{border:1px solid #ff2e2e;padding:10px;margin-top:10px;border-radius:8px}
.small{font-size:13px;color:#bbb}
</style>
</head>
<body>

<h2>ğŸ”¥ Razx RP Support & Development</h2>

<!-- CITIZEN -->
<div class="box">
<h3>ğŸ‘¤ Citizen Ticket</h3>
<input id="cname" placeholder="Name">
<input id="cemail" placeholder="Email">
<select id="cat">
<option>Police</option><option>EMS</option>
<option>Gang</option><option>Other</option>
</select>
<textarea id="cmsg" placeholder="Problem / Development Idea"></textarea>
<button onclick="createTicket()">Submit Ticket</button>
</div>

<div class="box">
<h3>ğŸ“¥ Your Inbox</h3>
<div id="inbox" class="small">Enter email to load tickets</div>
</div>

<hr>

<!-- LOGIN -->
<div class="box">
<h3>ğŸ” Staff Login</h3>
<input id="lemail" placeholder="Email">
<input id="lpass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
</div>

<!-- OWNER -->
<div class="box" id="ownerBox" style="display:none">
<h3>ğŸ‘‘ Website Owner Panel</h3>
<input id="newEmail" placeholder="Email">
<select id="newRole">
<option value="chief">Chief Admin</option>
<option value="admin">Admin</option>
</select>
<button onclick="assignRole()">Assign Role</button>
</div>

<!-- CHIEF -->
<div class="box" id="chiefBox" style="display:none">
<h3>ğŸ”¥ Chief Admin â€“ Manage Admins</h3>
<div id="adminList"></div>
</div>

<!-- ADMIN -->
<div class="box" id="adminBox" style="display:none">
<h3>ğŸ› ï¸ Support Tickets</h3>
<div id="ticketList"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import {
 getFirestore, collection, addDoc, getDocs,
 query, where, doc, setDoc, deleteDoc, updateDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ğŸ”´ CHANGE THIS */
const OWNER_EMAIL = "owner@razxrp.com";

const firebaseConfig={
 apiKey:"PASTE",
 authDomain:"PASTE",
 projectId:"PASTE"
};

initializeApp(firebaseConfig);
const auth=getAuth();
const db=getFirestore();

/* TICKET CREATE */
window.createTicket=async()=>{
 const id="RZXP-"+Math.floor(Math.random()*99999);
 await addDoc(collection(db,"tickets"),{
  ticketId:id,
  name:cname.value,
  email:cemail.value,
  category:cat.value,
  message:cmsg.value,
  reply:"",
  status:"Pending",
  time:Date.now()
 });
 alert("Ticket Created: "+id);
 loadInbox();
};

/* CITIZEN INBOX */
async function loadInbox(){
 if(!cemail.value) return;
 inbox.innerHTML="";
 const q=query(collection(db,"tickets"),where("email","==",cemail.value));
 const s=await getDocs(q);
 s.forEach(d=>{
  const t=d.data();
  inbox.innerHTML+=`
   <div class="ticket">
   ğŸ« ${t.ticketId}<br>
   Status: <b>${t.status}</b><br>
   Reply: ${t.reply || "Waiting"}
   </div>`;
 });
}
cemail.onchange=loadInbox;

/* LOGIN */
window.login=()=>{
 signInWithEmailAndPassword(auth,lemail.value,lpass.value)
 .then(()=>checkRole(lemail.value))
 .catch(()=>alert("Login failed"));
};

/* ROLE CHECK */
async function checkRole(email){
 if(email===OWNER_EMAIL){
  ownerBox.style.display="block";
  chiefBox.style.display="block";
  adminBox.style.display="block";
 }
 const q=query(collection(db,"users"),where("email","==",email));
 const s=await getDocs(q);
 s.forEach(d=>{
  if(d.data().role==="chief"){
   chiefBox.style.display="block";
   adminBox.style.display="block";
  }
  if(d.data().role==="admin"){
   adminBox.style.display="block";
  }
 });
 loadAdmins();
 loadTickets();
}

/* OWNER ASSIGN ROLE */
window.assignRole=async()=>{
 await setDoc(doc(db,"users",newEmail.value),{
  email:newEmail.value,
  role:newRole.value
 });
 alert("Role Assigned");
 loadAdmins();
};

/* CHIEF FIRE ADMIN */
async function loadAdmins(){
 adminList.innerHTML="";
 const s=await getDocs(collection(db,"users"));
 s.forEach(d=>{
  if(d.data().role==="admin"){
   adminList.innerHTML+=`
    <p>${d.data().email}
    <button onclick="fireAdmin('${d.id}')">Fire âŒ</button></p>`;
  }
 });
}
window.fireAdmin=async(id)=>{
 await deleteDoc(doc(db,"users",id));
 alert("Admin Fired");
 loadAdmins();
};

/* ADMIN TICKETS */
async function loadTickets(){
 ticketList.innerHTML="";
 const s=await getDocs(collection(db,"tickets"));
 s.forEach(d=>{
  const t=d.data();
  ticketList.innerHTML+=`
   <div class="ticket">
   ğŸ« ${t.ticketId} | ${t.category}<br>
   ${t.message}<br>
   <input id="r${d.id}" placeholder="Reply">
   <select id="s${d.id}">
    <option>Pending</option>
    <option>Replied</option>
    <option>Closed</option>
   </select>
   <button onclick="reply('${d.id}')">Send</button>
   </div>`;
 });
}
window.reply=async(id)=>{
 const r=document.getElementById("r"+id).value;
 const s=document.getElementById("s"+id).value;
 await updateDoc(doc(db,"tickets",id),{
  reply:r,status:s
 });
 alert("Updated");
};
</script>
</body>
  </html><!DOCTYPE html>
<html>
<head>
<title>Razx RP Support System</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{background:#0b0b0b;color:#fff;font-family:Arial}
h2,h3{color:#ff2e2e}
.box{background:#151515;padding:15px;margin:10px;border-radius:10px}
input,textarea,select,button{
 width:100%;padding:10px;margin-top:8px;
 border:none;border-radius:6px
}
button{background:#ff2e2e;color:white;font-weight:bold}
.ticket{border:1px solid #ff2e2e;padding:10px;margin-top:10px;border-radius:8px}
.small{font-size:13px;color:#bbb}
</style>
</head>
<body>

<h2>ğŸ”¥ Razx RP Support & Development</h2>

<!-- CITIZEN -->
<div class="box">
<h3>ğŸ‘¤ Citizen Ticket</h3>
<input id="cname" placeholder="Name">
<input id="cemail" placeholder="Email">
<select id="cat">
<option>Police</option><option>EMS</option>
<option>Gang</option><option>Other</option>
</select>
<textarea id="cmsg" placeholder="Problem / Development Idea"></textarea>
<button onclick="createTicket()">Submit Ticket</button>
</div>

<div class="box">
<h3>ğŸ“¥ Your Inbox</h3>
<div id="inbox" class="small">Enter email to load tickets</div>
</div>

<hr>

<!-- LOGIN -->
<div class="box">
<h3>ğŸ” Staff Login</h3>
<input id="lemail" placeholder="Email">
<input id="lpass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
</div>

<!-- OWNER -->
<div class="box" id="ownerBox" style="display:none">
<h3>ğŸ‘‘ Website Owner Panel</h3>
<input id="newEmail" placeholder="Email">
<select id="newRole">
<option value="chief">Chief Admin</option>
<option value="admin">Admin</option>
</select>
<button onclick="assignRole()">Assign Role</button>
</div>

<!-- CHIEF -->
<div class="box" id="chiefBox" style="display:none">
<h3>ğŸ”¥ Chief Admin â€“ Manage Admins</h3>
<div id="adminList"></div>
</div>

<!-- ADMIN -->
<div class="box" id="adminBox" style="display:none">
<h3>ğŸ› ï¸ Support Tickets</h3>
<div id="ticketList"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import {
 getFirestore, collection, addDoc, getDocs,
 query, where, doc, setDoc, deleteDoc, updateDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ğŸ”´ CHANGE THIS */
const OWNER_EMAIL = "owner@razxrp.com";

const firebaseConfig={
 apiKey:"PASTE",
 authDomain:"PASTE",
 projectId:"PASTE"
};

initializeApp(firebaseConfig);
const auth=getAuth();
const db=getFirestore();

/* TICKET CREATE */
window.createTicket=async()=>{
 const id="RZXP-"+Math.floor(Math.random()*99999);
 await addDoc(collection(db,"tickets"),{
  ticketId:id,
  name:cname.value,
  email:cemail.value,
  category:cat.value,
  message:cmsg.value,
  reply:"",
  status:"Pending",
  time:Date.now()
 });
 alert("Ticket Created: "+id);
 loadInbox();
};

/* CITIZEN INBOX */
async function loadInbox(){
 if(!cemail.value) return;
 inbox.innerHTML="";
 const q=query(collection(db,"tickets"),where("email","==",cemail.value));
 const s=await getDocs(q);
 s.forEach(d=>{
  const t=d.data();
  inbox.innerHTML+=`
   <div class="ticket">
   ğŸ« ${t.ticketId}<br>
   Status: <b>${t.status}</b><br>
   Reply: ${t.reply || "Waiting"}
   </div>`;
 });
}
cemail.onchange=loadInbox;

/* LOGIN */
window.login=()=>{
 signInWithEmailAndPassword(auth,lemail.value,lpass.value)
 .then(()=>checkRole(lemail.value))
 .catch(()=>alert("Login failed"));
};

/* ROLE CHECK */
async function checkRole(email){
 if(email===OWNER_EMAIL){
  ownerBox.style.display="block";
  chiefBox.style.display="block";
  adminBox.style.display="block";
 }
 const q=query(collection(db,"users"),where("email","==",email));
 const s=await getDocs(q);
 s.forEach(d=>{
  if(d.data().role==="chief"){
   chiefBox.style.display="block";
   adminBox.style.display="block";
  }
  if(d.data().role==="admin"){
   adminBox.style.display="block";
  }
 });
 loadAdmins();
 loadTickets();
}

/* OWNER ASSIGN ROLE */
window.assignRole=async()=>{
 await setDoc(doc(db,"users",newEmail.value),{
  email:newEmail.value,
  role:newRole.value
 });
 alert("Role Assigned");
 loadAdmins();
};

/* CHIEF FIRE ADMIN */
async function loadAdmins(){
 adminList.innerHTML="";
 const s=await getDocs(collection(db,"users"));
 s.forEach(d=>{
  if(d.data().role==="admin"){
   adminList.innerHTML+=`
    <p>${d.data().email}
    <button onclick="fireAdmin('${d.id}')">Fire âŒ</button></p>`;
  }
 });
}
window.fireAdmin=async(id)=>{
 await deleteDoc(doc(db,"users",id));
 alert("Admin Fired");
 loadAdmins();
};

/* ADMIN TICKETS */
async function loadTickets(){
 ticketList.innerHTML="";
 const s=await getDocs(collection(db,"tickets"));
 s.forEach(d=>{
  const t=d.data();
  ticketList.innerHTML+=`
   <div class="ticket">
   ğŸ« ${t.ticketId} | ${t.category}<br>
   ${t.message}<br>
   <input id="r${d.id}" placeholder="Reply">
   <select id="s${d.id}">
    <option>Pending</option>
    <option>Replied</option>
    <option>Closed</option>
   </select>
   <button onclick="reply('${d.id}')">Send</button>
   </div>`;
 });
}
window.reply=async(id)=>{
 const r=document.getElementById("r"+id).value;
 const s=document.getElementById("s"+id).value;
 await updateDoc(doc(db,"tickets",id),{
  reply:r,status:s
 });
 alert("Updated");
};
</script>
</body>
  </html>
